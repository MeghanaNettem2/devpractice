node 
{
   stage('Preparation') 
   { 
      git 'https://github.com/jayanthikr91/Assignment2.git'

   }
   stage('Build')
   {
          sh "mvn clean install" 
   }
   stage('SonarQube analysis') 
    { 
         sh 'mvn sonar:sonar -Dsonar.host.url=http://my40867dns.eastus2.cloudapp.azure.com' 
     }
     stage('Artifactory upload')
     	{
		
def server = Artifactory.newServer  url: "http://my10107dns.eastus2.cloudapp.azure.com/artifactory",username:'admin',password:'password'
def uploadSpec = """{
 	
"files":[
{
"pattern":"target/*.war",
"target":"hello/"
}
]
}"""
server.upload(uploadSpec)
def downloadSpec = """{
 	
"files":[
{
"pattern":"hello/*.war",
"target":"/var/lib/jenkins/workspace/artdwnloadpipeline/"
}
]
}"""
server.download(downloadSpec)

    }
 
}
